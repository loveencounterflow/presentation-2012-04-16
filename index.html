<!DOCTYPE html>
<html>
<head>
<title>LSD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="duration" content="20">
<link rel="stylesheet" href="./Slidy2/styles/slidy.css" type="text/css">
<link rel="stylesheet" href="./resources/own.css" type="text/css">
<script src="./Slidy2/scripts/slidy.js" charset="utf-8" type="text/javascript">
</script>
</head>
<body>

<div class="slide">
<h1 id="coffeenode-an-application-basework">CoffeeNode, an Application Basework</h1>
<blockquote>
<p>“JavaScript is too important to be left to the experts.”—<em>Jeremy Ashkenas, creator of CoffeeScript</em></p>
</blockquote>
<p id="section"></p>
</div>
<div class="slide">
<h1 id="prelude-what-made-me-leave-python">Prelude: What Made me Leave Python</h1>
<h2 id="after-10-years-of-loving-it">after 10 Years of Loving it</h2>
<ul>
<li><p>I earned the <em>Popular Question</em> badge on StackOverflow.com 3 times:</p>
<ul>
<li><p>Is it possible to use <strong>re2</strong> from Python? (2010)</p></li>
<li><p>how to install <strong>pycairo for python 3</strong> on Ubuntu 10.04? (2011)</p></li>
<li><p>how to do <strong>asynchronous http</strong> requests with epoll and <strong>python 3.1</strong>? (2010)</p></li>
</ul></li>
<li><p>all questions were hard—3373 views in 33 months generated only 10 answers total or 3⅓ answers per. That’s 3 views per day, but only one answer in 3 days.</p></li>
<li><p>Realize something?</p></li>
<li><p>All questions remained essentially unanswered</p></li>
<li><p>and the last one did it.</p></li>
<li><p>Good riddance, good bye</p></li>
<li><p>Helo NodeJS</p></li>
</ul>
<blockquote>
<p>(see <a href="http://stackoverflow.com/questions/2439345">http://stackoverflow.com/questions/2439345</a>, <a href="http://stackoverflow.com/questions/6232529">6232529</a>, and <a href="http://stackoverflow.com/questions/2489780">2489780</a>)</p>
</blockquote>
<p id="section-1"></p>
</div>
<div class="slide">
<h1 id="prelude-what-made-me-leave-oop">Prelude: What Made me Leave OOP</h1>
<h2 id="after-10-years-of-trying-to-love-it">after 10 Years of Trying to Love it</h2>
<ul>
<li>to quote:</li>
</ul>
<blockquote>
<p>“The last step forward was object-oriented programming […] the next step is all overdue: we should’ve been there by now and we haven’t—we’re still in the object-oriented stage.”—<a href="http://www.youtube.com/watch?v=yh7TeoEwNyI">Douglas Crockford, <em>Web Forward</em>, keynote to the 2008 Frontend Engineering Summit at Yahoo!</a></p>
</blockquote>
<blockquote>
<p>“Object Oriented Programming puts the Nouns first and foremost. Why would you go to such lengths to put one part of speech on a pedestal? Why should one kind of concept take precedence over another? It’s not as if OOP has suddenly made verbs less important in the way we actually think. It’s a strangely skewed perspective.”—<a href="http://steve-yegge.blogspot.com/2006/03/execution-in-kingdom-of-nouns.html">Steve Yegge, <em>Execution in the Kingdom of Nouns</em></a></p>
</blockquote>
<ul>
<li><p>This is Java, unmistakably:</p>
<pre><code>RidersGuild.getRiderNotificationSubscriberList().getBroadcaster().run(
  new BroadcastMessage(StableFactory.getNullHorseInstance()));
</code></pre></li>
<li><p>OOP in itself does little to take complexity out of programming—in fact, my impression is that OOP <em>encourages</em> complexity:</p>
<blockquote>
<p>The problems that the [Enterprise JavaBeans] standard was attempting to address, such as object-relational mapping and transactional integrity, were complex, however many programmers found the APIs to be just as difficult, leading to a perception that EJBs introduced complexity without delivering real benefits.—<a href="http://en.wikipedia.org/wiki/Enterprise_JavaBeans">Wikipedia</a></p>
</blockquote>
<p>I could describe my experience with <a href="http://www.sqlalchemy.org/">SQLAlchemy</a> (a Python ORM toolkit) with the exactly same words. ORM is somewhat hard, but in the end i went back to handwritten SQL queries (with interpolated variable contents) simply because it was conceptually so much less of a burden.</p></li>
</ul>
<p id="section-2"></p>
</div>
<div class="slide">
<h1 id="approaches-to-programming">Approaches to Programming</h1>
<ul>
<li><p>Engineering</p></li>
<li><p>Architecture</p></li>
<li><p>Something completely different: ‘Computer Science’, ‘Informatics’</p></li>
<li><p>Linguistics</p></li>
</ul>
<p id="section-3"></p>
</div>
<div class="slide">
<h1 id="language-is-important">Language is Important</h1>
<ul>
<li><p>Computers don’t need readable programs—humans do.</p>
<p>Literate Programming can provide tools to make organized, beautiful source code and documentation, but no amount of CSS can demystify a badly chosen variable name.</p>
<blockquote>
<p>“Programs are not just a technical contrivance, they are a medium of intentional communication—with the machine, but more importantly with your development community, and ultimately with yourself.”—Douglas Crockford, <em>Quality</em>, talk delivered on Yahoo!’s internal Frontend Engineering Summit in 2007, <a href="http://www.youtube.com/watch?v=t9YLtDJZtPY">http://www.youtube.com/watch?v=t9YLtDJZtPY</a></p>
</blockquote></li>
<li><p>This talk is all about enabling programmers to write more readable programs:</p>
<blockquote>
<p>“The simplest thing we can do to enhance the value of our codebase is to make our programs more readable.”—Douglas Crockford, <em>Quality</em>, talk delivered on Yahoo!’s internal Frontend Engineering Summit in 2007, <a href="http://www.youtube.com/watch?v=t9YLtDJZtPY">http://www.youtube.com/watch?v=t9YLtDJZtPY</a></p>
</blockquote></li>
</ul>
<p id="section-4"></p>
</div>
<div class="slide">
<h1 id="coffeenode-data-type-therapy">CoffeeNode Data Type Therapy</h1>
<p id="section-5"></p>
</div>
<div class="slide">
<h1 id="what-is-a-data-type">What is a Data Type?</h1>
<ul>
<li><p>A classification of data</p></li>
<li><p>based on their underlying storage needs (extension)</p></li>
<li><p>and intended semantics &amp; use (intention).</p></li>
</ul>
<p id="section-6"></p>
</div>
<div class="slide">
<h1 id="how-are-data-types-represented">How are Data Types Represented?</h1>
<ul>
<li><p>In JavaScript, the <code>typeof</code> operator returns a string</p></li>
<li><p>whereas in Python, types are represented by the objects that implement them (the reality is a little more complicated).</p></li>
<li><p>Representing / identifying (classes of) things by texts is straightforward, simple, accessible and extensible</p></li>
<li><p>it works for 7 billion people and their pets</p></li>
<li><p>it works for the 171,476 words of English (in the OED)</p></li>
<li><p>so it should be good enough for this purpose.</p></li>
<li><p>Examples:</p>
<ul>
<li><p>built-in JavaScript types:</p>
<pre><code>'text'
'number'
'boolean'
'jsdate'
</code></pre></li>
<li><p>CoffeeNode extension types:</p>
<pre><code>'SET/set'
'HTML/document'
</code></pre></li>
<li><p>3rd party types:</p>
<pre><code>'example.com/FOO/bar'
</code></pre></li>
</ul></li>
</ul>
<p id="section-7"></p>
</div>
<div class="slide">
<h1 id="js-types--are-they-good-enough">JS Types—Are they Good Enough?</h1>
<ul>
<li><p>Short answer: No.</p></li>
<li><p>Long answer:</p>
<ul>
<li><p>these work:</p>
<table>
<thead>
<tr class="header">
<th align="left"><code>value =</code></th>
<th align="left"><code>typeof value</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>true</code></td>
<td align="left"><code>'boolean'</code></td>
</tr>
<tr class="even">
<td align="left"><code>-&gt;</code></td>
<td align="left"><code>'function'</code></td>
</tr>
<tr class="odd">
<td align="left"><code>'text'</code></td>
<td align="left"><code>'string'</code></td>
</tr>
<tr class="even">
<td align="left"><code>undefined</code></td>
<td align="left"><code>'undefined'</code></td>
</tr>
<tr class="odd">
<td align="left"><code>new Object()</code></td>
<td align="left"><code>'object'</code></td>
</tr>
<tr class="even">
<td align="left"><code>42</code></td>
<td align="left"><code>'number'</code></td>
</tr>
</tbody>
</table></li>
<li><p>this is doubtful:</p>
<table>
<thead>
<tr class="header">
<th align="left"><code>value =</code></th>
<th align="left"><code>typeof value</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>Infinity</code></td>
<td align="left"><code>'number'</code></td>
</tr>
</tbody>
</table></li>
<li><p>this is troublesome:</p>
<table>
<thead>
<tr class="header">
<th align="left"><code>value =</code></th>
<th align="left"><code>typeof value</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>NaN</code></td>
<td align="left"><code>'number'</code></td>
</tr>
</tbody>
</table></li>
<li><p>and the rest is silence, painful silence:</p>
<table>
<thead>
<tr class="header">
<th align="left"><code>value =</code></th>
<th align="left"><code>typeof value</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>[]</code></td>
<td align="left"><code>'object'</code></td>
</tr>
<tr class="even">
<td align="left"><code>{}</code></td>
<td align="left"><code>'object'</code></td>
</tr>
<tr class="odd">
<td align="left"><code>new Date()</code></td>
<td align="left"><code>'object'</code></td>
</tr>
<tr class="even">
<td align="left"><code>global</code></td>
<td align="left"><code>'object'</code></td>
</tr>
<tr class="odd">
<td align="left"><code>new RegExp()</code></td>
<td align="left"><code>'object'</code></td>
</tr>
<tr class="even">
<td align="left"><code>new Error()</code></td>
<td align="left"><code>'object'</code></td>
</tr>
<tr class="odd">
<td align="left"><code>arguments</code></td>
<td align="left"><code>'object'</code></td>
</tr>
<tr class="even">
<td align="left"><code>null</code></td>
<td align="left"><code>'object'</code></td>
</tr>
</tbody>
</table></li>
</ul></li>
<li><p>Likewise, the <code>instanceof</code> operator is deeply broken:</p>
<ul>
<li><p>these are OK:</p>
<pre><code>typeof 42 == 'number'                   # true
( new Number 42 ) instanceof Number     # true
NaN instanceof Number                   # false
</code></pre></li>
<li><p>these are nuts:</p>
<pre><code>typeof NaN == 'number'                  # true
42 instanceof Number                    # false
</code></pre></li>
</ul></li>
<li><p>Testing whether a result is a number or not is really important in JavaScript because <code>1 / 0</code> and <code>1 * 'foo'</code> yield <code>Infinity</code> and <code>NaN</code>, respectively.</p></li>
<li><p>⚞OMFG⚟</p></li>
</ul>
<p id="section-8"></p>
</div>
<div class="slide">
<h1 id="remedy-the-miller-device">Remedy: The Miller Device</h1>
<ul>
<li>Fortunately, there is a <code>toString</code> method in <code>Object.protype</code> that behaves a tad more civilized:</li>
</ul>
<table>
<caption>Return values of <code>Object::toString</code></caption>
<thead>
<tr class="header">
<th align="left">value</th>
<th align="left"><code>Object::toString.call value</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>true</code></td>
<td align="left"><code>[object Boolean]</code></td>
</tr>
<tr class="even">
<td align="left"><code>-&gt;</code></td>
<td align="left"><code>[object Function]</code></td>
</tr>
<tr class="odd">
<td align="left"><code>'text'</code></td>
<td align="left"><code>[object String]</code></td>
</tr>
<tr class="even">
<td align="left"><code>undefined</code></td>
<td align="left"><code>[object Undefined]</code></td>
</tr>
<tr class="odd">
<td align="left"><code>42</code></td>
<td align="left"><code>[object Number]</code></td>
</tr>
<tr class="even">
<td align="left"><code>Infinity</code></td>
<td align="left"><code>[object Number]</code></td>
</tr>
<tr class="odd">
<td align="left"><code>NaN</code></td>
<td align="left"><code>[object Number]</code></td>
</tr>
<tr class="even">
<td align="left"><code>[]</code></td>
<td align="left"><code>[object Array]</code></td>
</tr>
<tr class="odd">
<td align="left"><code>{}</code></td>
<td align="left"><code>[object Object]</code></td>
</tr>
<tr class="even">
<td align="left"><code>new Date()</code></td>
<td align="left"><code>[object Date]</code></td>
</tr>
<tr class="odd">
<td align="left"><code>global</code></td>
<td align="left"><code>[object global]</code></td>
</tr>
<tr class="even">
<td align="left"><code>new RegExp()</code></td>
<td align="left"><code>[object RegExp]</code></td>
</tr>
<tr class="odd">
<td align="left"><code>new Error()</code></td>
<td align="left"><code>[object Error]</code></td>
</tr>
<tr class="even">
<td align="left"><code>arguments</code></td>
<td align="left"><code>[object Arguments]</code></td>
</tr>
<tr class="odd">
<td align="left"><code>null</code></td>
<td align="left"><code>[object Null]</code></td>
</tr>
</tbody>
</table>
<p id="section-9"></p>
</div>
<div class="slide">
<h1 id="remedy-the-miller-device-1">Remedy: The Miller Device</h1>
<ul>
<li><p>We exploit the goodness of the Miller Device to arrive at a sane type system. From <code>COFFEENODE/TYPES.coffee</code>:</p>
<pre><code>#---------------------------------------------------------------------------------------------
js_type_of = ( x ) -&gt;
  return Object.prototype::call x

#---------------------------------------------------------------------------------------------
$.isa_list          = ( x ) -&gt; return ( js_type_of x ) == '[object Array]'
$.isa_boolean       = ( x ) -&gt; return ( js_type_of x ) == '[object Boolean]'
$.isa_function      = ( x ) -&gt; return ( js_type_of x ) == '[object Function]'
$.isa_pod           = ( x ) -&gt; return ( js_type_of x ) == '[object Object]'
$.isa_text          = ( x ) -&gt; return ( js_type_of x ) == '[object String]'
$.isa_number        = ( x ) -&gt; return ( js_type_of x ) == '[object Number]' and isFinite x
$.isa_infinity      = ( x ) -&gt; return x == Infinity or x == -Infinity
$.isa_null          = ( x ) -&gt; return x is null
#.............................................................................................
$.isa_jsundefined   = ( x ) -&gt; return x is undefined
$.isa_jsnotanumber  = ( x ) -&gt; return isNaN x
$.isa_jsarguments   = ( x ) -&gt; return ( js_type_of x ) == '[object Arguments]'
$.isa_jsdate        = ( x ) -&gt; return ( js_type_of x ) == '[object Date]'
$.isa_jsglobal      = ( x ) -&gt; return ( js_type_of x ) == '[object global]'
$.isa_jsregex       = ( x ) -&gt; return ( js_type_of x ) == '[object RegExp]'
$.isa_jserror       = ( x ) -&gt; return ( js_type_of x ) == '[object Error]'
$.isa_jswindow      = ( x ) -&gt; return ( js_type_of x ) == '[object DOMWindow]'
$.isa_jsctx         = ( x ) -&gt; return ( js_type_of x ) == '[object CanvasRenderingContext2D]'
$.isa_jsarraybuffer = ( x ) -&gt; return ( js_type_of x ) == '[object ArrayBuffer]'

#---------------------------------------------------------------------------------------------
coffeenode_type_by_js_type =
  '[object Array]':                     'list'
  '[object Boolean]':                   'boolean'
  '[object Function]':                  'function'
  '[object Null]':                      'null'
  '[object String]':                    'text'
  '[object Object]':                    'pod'
  #...........................................................................................
  '[object Undefined]':                 'jsundefined'
  '[object Arguments]':                 'jsarguments'
  '[object Date]':                      'jsdate'
  '[object Error]':                     'jserror'
  '[object global]':                    'jsglobal'
  '[object RegExp]':                    'jsregex'
  '[object DOMWindow]':                 'jswindow'
  '[object CanvasRenderingContext2D]':  'jsctx'
  '[object ArrayBuffer]':               'jsarraybuffer'
  #...........................................................................................
  '[object Number]': ( x ) -&gt;
    return 'jsnotanumber' if isNaN x
    return 'jsinfinity'   if x == Infinity or x == -Infinity
    return 'number'


# **NB**: this is the preliminary version of `type_of`; the final version is shown later.

#---------------------------------------------------------------------------------------------
$.type_of = ( x ) -&gt;
  &quot;&quot;&quot;Given any kind of value ``x``, return its type.&quot;&quot;&quot;
  R = coffeenode_type_by_js_type[ js_type_of x ]
  unless R? then throw new Error &quot;unable to determine type of #{rpr x}&quot;
  return if @isa_function R then R x else R
</code></pre></li>
<li><p>Usage:</p>
<pre><code>log type_of        1 / 0            # jsinfinity
log isa_jsinfinity 1 / 0            # true
log isa_number     1 / 0            # false
</code></pre></li>
</ul>
<p id="section-10"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it">Type Hierarchy (and what we can do with it)</h1>
<h2 id="native-javascript-types">Native JavaScript Types</h2>
<ul>
<li><p>The native JavaScript data types are divided into three groups:</p></li>
<li><p>The first group contains all the ‘universally accepted’ data types; there are seven of these, all of which (except <code>function</code>) are directly representable in JSON. I call this set the ‘basic’ data types:</p>
<ul>
<li><code>list</code></li>
<li><code>boolean</code></li>
<li><code>function</code></li>
<li><code>null</code></li>
<li><code>text</code></li>
<li><code>pod</code></li>
<li><code>number</code></li>
</ul></li>
<li><p>The second group contains data types that are not nearly as universally accepted across languages, but they are present in all modern JavaScript VMs.</p>
<p><strong>NB</strong> that while the <em>types</em> <code>jsnotanumber</code> and <code>jsinfinity</code> are introduced by CoffeeNode, the <em>values</em> are available in all JS VMs:</p>
<ul>
<li><code>jsundefined</code></li>
<li><code>jsarguments</code></li>
<li><code>jsdate</code></li>
<li><code>jserror</code></li>
<li><code>jsglobal</code></li>
<li><code>jsregex</code></li>
<li><code>jsnotanumber</code></li>
<li><code>jsinfinity</code></li>
</ul></li>
<li><p>The third group contains data types that may only be present in some environments, depending e.g. you’re running code in NodeJS on the server or in, say, on SpiderMonkey in Firefox:</p>
<ul>
<li><code>jsglobal</code></li>
<li><code>jswindow</code></li>
<li><code>jsctx</code></li>
<li><code>jsarraybuffer</code></li>
</ul></li>
</ul>
<p id="section-11"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-1">Type Hierarchy (and what we can do with it)</h1>
<h2 id="issues-with-native-types">Issues with Native Types</h2>
<ul>
<li>A <span style="text-decoration: line-through;">short</span> TL;DR discussion of issues with JS data types:</li>
</ul>
<dl>
<dt><code>jsundefined</code></dt>
<dd><p>… it’s OK to have a value to represent something that doesn’t exist, but it’s not cool to make one value represent a number of completely unrelated code quality issues:</p>
<pre><code>f = ( x, y ) -&gt;
    bye 'no value given for y' unless y?

d = { a: 42 }
f d[ 'a' ]                  # fails because `f` was called with too few arguments
f d[ 'a' ], d[ 'b' ]        # fails because `d` has no member `b`
</code></pre>
</dd>
<dt><code>jsnotanumber</code></dt>
<dd><p>… <code>NaN</code>, which appears as the result of some bogus operations, such as adding a number and a text that does not ‘look like’ a number; this value is crazy to the point it identifies itself as a number. Don’t touch, move on.</p>
</dd>
<dt><code>jsinfinity</code></dt>
<dd><p>… appears as the result of some other bogus operations, such as</p>
<ul>
<li><code>1 / 0</code> (Wikipedia: “Division by zero must be left undefined in any mathematical system that obeys the axioms of a field.”),</li>
<li><code>Math.max()</code> (how many apples does the fullest basket contain if there are no baskets?).</li>
</ul>
</dd>
<dt><code>jsarguments</code></dt>
<dd><p>… a strange thing that wants to be a list ever so badly; it is sometimes very practical to have, but is missing from competing languages and will in a few years get removed from JavaScript, too.</p>
</dd>
<dt><code>jsdate</code></dt>
<dd><p>… which is extremely difficult to handle correctly, and full of subtle bugs.</p>
</dd>
<dt><code>jserror</code></dt>
<dd><p>… the one data type in this group that looks OK.</p>
</dd>
<dt><code>jsregex</code></dt>
<dd><p>… full of strange API decisions, bugs and unfixable shortcomings—see <a href="http://blog.stevenlevithan.com">http://blog.stevenlevithan.com</a>.</p>
</dd>
</dl>
<p id="section-12"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-2">Type Hierarchy (and what we can do with it)</h1>
<h2 id="equality-nope.">Equality? Nope.</h2>
<ul>
<li><p>CoffeeNode tries to make programming in JavaScript easier and more fun, and to enhance program correctness.</p></li>
<li><p>Among the basic things that don’t work very well in plain JavaScript are equality and containedness with collection data types</p></li>
<li><p>which means that <code>[] == []</code> and <code>{} == {}</code> are <code>false</code> when they should be <code>true</code></p></li>
<li><p>and also <code>[ 456, 893, [ 5, 6, 7, ], ].indexOf [ 5, 6, 7, ]</code> gives <code>-1</code> (‘not found’) instead of <code>2</code>.</p></li>
<li><p>JavaScript’s <code>===</code> (CoffeeScript: <code>==</code>) ‘strict equality operator’ is more like a ‘object identity operator’</p></li>
</ul>
<p id="section-13"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-3">Type Hierarchy (and what we can do with it)</h1>
<h2 id="example-code-listequals">Example Code: <code>LIST/equals</code></h2>
<ul>
<li><p>How can we fix equality and containment?</p></li>
<li><p>Sadly, there is no way to override the behavior of <code>==</code> and <code>===</code>.</p></li>
<li><p>It isn’t advisable, either—such a global language change could easily affect code acting under the premise that</p>
<pre><code>( [] == [] ) == false
</code></pre></li>
<li><p>Don’t Monkey-Patch. Ever. Except if.</p></li>
<li><p>So we have to put the functionality into libraries.</p></li>
<li><p><strong>Example</strong>: from <code>COFFEENODE/jstypes/LIST/implementation.coffee</code> (<strong>NB</strong> this code is from the <em>implementation</em> submodule of <code>LIST</code>—you’d ordinarily call <code>LIST/main.cnd/equality</code>, which is a wrapper that checks argument number and that <code>me</code> is a <code>list</code>, and then returns the result of calling the below method):</p>
<pre><code>#---------------------------------------------------------------------------------------------
$.equals = ( me, probe ) -&gt;

  return false if not TYPES.isa_list probe
  return false if me.length != probe.length
  return true  if me.length == 0

  #...........................................................................................
  for idx in [ 0 ... me.length ]

    #.........................................................................................
    my_element      = me[    idx ]
    your_element    = probe[ idx ]

    return false if ( TYPES.type_of my_element ) != ( TYPES.type_of your_element )
    return false if not Σ.emit &quot;!Δ/call/specific/equals&quot;, my_element, your_element

  #...........................................................................................
  return true
</code></pre></li>
<li><p>The magic happens in the Σ library</p></li>
<li><p>which lives at <a href="https://github.com/loveencounterflow/COFFEENODE-SIGMA"><code class="url">https://github.com/loveencounterflow/COFFEENODE-SIGMA</code></a></p></li>
<li><p>and is a synchronous signal handling library.</p></li>
<li><p>More later.</p></li>
</ul>
<p id="section-14"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-4">Type Hierarchy (and what we can do with it)</h1>
<h2 id="example-code-listcontains">Example Code: <code>LIST/contains</code></h2>
<ul>
<li><p>From <code>COFFEENODE/jstypes/LIST/implementation.coffee</code>:</p>
<pre><code>#---------------------------------------------------------------------------------------------
$.contains = ( me, probe ) -&gt;

  #...........................................................................................
  # If ``List.indexOf`` reports a hit, we definitely know it is so and return ``true``:

  return true if ( me.indexOf probe ) &gt; -1

  #...........................................................................................
  # We know the miss is authoritative if ``probe`` can be equality-tested with JavaScript's
  # ``===`` operator:

  type_of_probe = TYPES.type_of probe
  return false if TYPES.simple_equality_types[ type_of_probe ]

  #...........................................................................................
  for value in me
    type_of_value = TYPES.type_of value

    #.........................................................................................
    # We can trivially skip ahead if
    # * the type of the value and the type of the probe differ
    # * or if the value type is on the 'simple equality' list:

    continue if type_of_value isnt type_of_probe
    continue if TYPES.simple_equality_types[ type_of_value ]

    #.........................................................................................
    return true if Σ.emit &quot;!Δ/call/specific/equals&quot;, probe, value

  #...........................................................................................
  return false
</code></pre></li>
</ul>
<p id="section-15"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-5">Type Hierarchy (and what we can do with it)</h1>
<h2 id="javascript-types-are-a-closed-set">JavaScript Types are a Closed Set</h2>
<ul>
<li><p>To repeat: <em>Each</em> piece of data has a type.</p></li>
<li><p>In JavaScript (and, therefore, CoffeeScript) this data type can only ever be one of</p>
<ul>
<li><code>list</code></li>
<li><code>boolean</code></li>
<li><code>function</code></li>
<li><code>null</code></li>
<li><code>text</code></li>
<li><code>pod</code></li>
<li><code>number</code></li>
<li><code>jsarguments</code></li>
<li><code>jsdate</code></li>
<li><code>jserror</code></li>
<li><code>jsglobal</code></li>
<li><code>jsregex</code></li>
<li><code>jsnotanumber</code></li>
<li><code>jsinfinity</code></li>
</ul></li>
<li><p>Additionally, though, JavaScript may have a number of host object data types:</p>
<ul>
<li><code>jsglobal</code></li>
<li><code>jswindow</code></li>
<li><code>jsctx</code></li>
</ul></li>
<li><p>(plus some things we omitted here, like an image on an HTML page).</p></li>
<li><p>You would have to write some C extension to your JavaScript VM to add a type</p></li>
<li><p>but whatever VM you use, the available types form a closed set at run time. And most added objects don’t bother for typing; they just ‘look like’ ordinary plain objects, so you would have to inspect attributes to classify them.</p></li>
</ul>
<p id="section-16"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-6">Type Hierarchy (and what we can do with it)</h1>
<h2 id="extended-types-are-an-open-set">Extended Types are an Open Set</h2>
<ul>
<li><p>But JavaScript is very flexible, so you can build arbitrary objects. From <code>COFFEENODE/SET</code>:</p>
<pre><code>#---------------------------------------------------------------------------------------------
$.new = ( x = null ) -&gt;
  &quot;&quot;&quot;Given any number of elements, return a set containing these elements.&quot;&quot;&quot;

  #...........................................................................................
  elements = {}
  R        =
    '~isa':                   'SET/set'
    'elements':               elements

  #...........................................................................................
  if x?
    type = TYPES.type_of x
    unless TYPES.is_facetted x then bye &quot;need a collection, got a #{type}&quot;

    #.........................................................................................
    switch type
      #.......................................................................................
      when 'list', 'text'
        for element in x
          elements[ HASH.as_hash_key element ] = 1
      #.......................................................................................
      when 'pod'
        for name, value of x
          elements[ HASH.as_hash_key value ] = 1
      #.......................................................................................
      else
        return Σ.emit '!Δ/call/specific/as_set', x

  #...........................................................................................
  return R
</code></pre></li>
<li><p>Using this code in a <code>*.cnd</code> module (the <code>new_set</code> vocable courtesy of the LSD system that augments <code>*.cnd</code> files):</p>
<pre><code>log new_set 'helo world'
</code></pre>
<p>gives you</p>
<pre><code>{   ~isa:     'SET/set'
    elements:
      h:      1
      e:      1
      l:      1
      o:      1
      ' ':    1
      w:      1
      r:      1
      d:      1
      }
</code></pre></li>
<li><p>which is basically a plain old dictionary (POD) that gives its extension type as a name under the key <code>~isa</code></p></li>
<li><p>and contains a sub-POD <code>elements</code> that keeps the records.</p></li>
</ul>
<p id="section-17"></p>
</div>
<div class="slide">
<h1 id="wait--.cnd-files">Wait—<code>*.cnd</code> Files???</h1>
<h2 id="theyre-just-coffeescript">They’re just CoffeeScript</h2>
<ul>
<li><p><code>cnd</code> is short for ‘CoffeeNode’.</p></li>
<li><p><code>*.cnd</code> files implement a kind of ‘augmented’ CoffeeScript</p></li>
<li><p>where the grammar is left untouched</p></li>
<li><p>but vocabulary gets injected prior to execution.</p></li>
<li><p>You run them with</p>
<pre><code>cnd run route/to/your/script.cnd
</code></pre></li>
<li><p>It all happens in <code>COFFEENODE/ENGINE/wrap-0.0.3.coffee</code>, where the <code>cnd</code> extension gets registered:</p>
<pre><code>#-----------------------------------------------------------------------------------------
require.extensions[ '.cnd' ] = ( module, route ) -&gt;
  source  = njs_fs.readFileSync route, 'utf-8'
  #.......................................................................................
  content = Σ.emit 'COFFEENODE/engine/wrap/0.0.3',
    'module':   module
    'route':    route
    'source':   source
  #.......................................................................................
  module._compile content, route
</code></pre></li>
<li><p>The transformation of the source code is quite primitive: we simply iterate over all the identifiers in the source, and where words are found that belong to the received vocabulary, we either add a signal emitter or a <code>require</code> statement. This:</p>
<pre><code>names = []
for word in words_of 'Alpha Beta Gamma'
  push names, word

log names
log reverse copy names
</code></pre>
<p>gets transposed into this:</p>
<pre><code>#---------------------------------------------------------------------------------------
# Minimal standard vocabulary
$           = exports ? @
bye         = ( P... ) -&gt; throw new Error P...
log         = ( require 'COFFEENODE/ENGINE/get-log-method' )()
echo        = console.log

#---------------------------------------------------------------------------------------&quot;
# Δ methods and standard libraries

Λ = require 'COFFEENODE/Λ/implementation'
words_of = Λ.get_emitter 'words_of'
push = Λ.get_emitter 'push'
reverse = Λ.get_emitter 'reverse'
copy = Λ.get_emitter 'copy'

names = []
for word in words_of 'Alpha Beta Gamma'
  push names, word

log names
log reverse copy names
</code></pre></li>
<li><p>Since the additional vocabulary is injected at the top of the script, you can always use your own semantics—so if you define your own <code>push</code> function, you will get your own function, not the CoffeeNode version.</p></li>
</ul>
<p id="section-18"></p>
</div>
<div class="slide">
<h1 id="wait--.cnd-files-1">Wait—<code>*.cnd</code> Files???</h1>
<h2 id="the-vocabulary">The Vocabulary</h2>
<ul>
<li><p>Currently there are three groups of words that qualify for automatic inclusion in <code>*.cnd</code> files:</p>
<ul>
<li><p>Specific Δ Methods: they are dispatched to the type library that is associated with the type of the first argument in the call (a.k.a. the ‘prinicipal noun’).</p></li>
<li><p>Generic Δ Methods: they are dispatched to the library that is identified in a registry (more later).</p></li>
<li><p>Libraries included in the <code>COFFEENODE/library</code> folder.</p></li>
</ul></li>
<li><p>Naming conventions:</p>
<ul>
<li><p>Δ methods should be fully spelled-out verbs or verb-ish expressions: <code>push</code>, <code>reverse</code>, <code>sort</code>, <code>copy</code>, <code>clear</code>, <code>compose</code>, <code>names_of</code>, <code>validate_isa_text</code>. There are a few accepted abbreviations, such as <code>rpr</code> for the ‘representation’ of a value, <code>idx</code> for ‘index’, <code>chr</code> for ‘character’.</p></li>
<li><p>CoffeeNode library names are spelled in SCREAMING CAPS using the Latin and the Greek alphabet.</p></li>
</ul></li>
</ul>
<p id="section-19"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-7">Type Hierarchy (and what we can do with it)</h1>
<h2 id="having-fun-with-sets">Having Fun with Sets</h2>
<ul>
<li><p>A real advantage over using Plain Old JavaScript Objects directly is the type-safety of CoffeeNode sets:</p>
<pre><code>log new_set [ 98765.432, null, true, 'abc', ]
</code></pre>
<p>gives</p>
<pre><code>{   ~isa:                 'SET/set',
    elements:
      '���n/98765.432':   1
      '���x/null':        1
      '���x/true':        1
      'abc':              1
      }
</code></pre></li>
<li><p>OK, that’s ugly.</p></li>
<li><p>The <code>���</code> result from <code>\ufdef</code>—a so-called Unicode surrogate code point which can never go single in a valid Unicode string. Well, here it does so, bending the rules without breaking them. Welcome to the Matrix.</p></li>
<li><p>JavaScript only ever uses texts for POD keys, but using this sigil we can (with very high certainty) ensure that our special strings don’t interfere with any other strings.</p></li>
<li><p>The <code>SET/contains</code> method (which coincides with <code>SET.has</code>) is <em>very</em> simple:</p>
<pre><code>#-----------------------------------------------------------------------------------------
$.contains = $.has = ( me, probe ) -&gt;
  return me[ 'elements' ][ HASH.as_hash_key probe ] isnt undefined
</code></pre></li>
<li><p>I just discover i should’ve really written <code>return POD.contains me[ 'elements' ], probe</code></p></li>
</ul>
<p id="section-20"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-8">Type Hierarchy (and what we can do with it)</h1>
<h2 id="type-checking">Type-Checking</h2>
<ul>
<li><p>So what happens if you throw unsuitable data at <code>new_set</code>?—Let’s try:</p></li>
<li><p><code>new_set new_set 'abc'</code> gives you</p>
<pre><code>Error: as_set is applicable to a set, but not implemented in COFFEENODE/jstypes/SET
</code></pre>
<p>This tells you that although a set is a suitable argument to <code>as_set</code>, it currently isn’t implemented (and maybe shouldn’t—still pondering this question).</p></li>
<li><p>How the hell does the system <em>know</em> this?</p></li>
<li><p><code>log new_set 42</code> gives you</p>
<pre><code>Error: 'as_set' is not applicable to a number;
'as_set' requires { +facetted },
but type 'number' is tagged with { basic, ecma, json, number, numeric }
and doesn't match the method description.
</code></pre></li>
<li><p>this tells you that in CoffeeNode, data types &amp; kinds are <em>tagged</em>.</p></li>
<li><p>Do you know of any other language / environment that tags data types? I think it’s elementary!</p></li>
</ul>
<p id="section-21"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-9">Type Hierarchy (and what we can do with it)</h1>
<h2 id="tagged-data-types-are-you-kidding">Tagged Data Types? Are you Kidding?</h2>
<ul>
<li><p>No, really.</p></li>
<li><p>A list is characterized as</p>
<ul>
<li><p><code>list</code>—each type is tagged with its own name; important for what follows.</p></li>
<li><p><code>mutable</code>–you can modify the object. Frozen lists (tuples) miss this tag.</p></li>
<li><p><code>facetted</code>—meaning you can do the <code>x[ foo ]</code> thing.</p></li>
<li><p><code>indexed</code>—meaning the <code>foo</code> in <code>x[ foo ]</code> must be a number.</p></li>
<li><p><code>dense</code>—a sparse list would be missing this tag.</p></li>
<li><p><code>ordered</code>—unlike a POD, which misses this tag.</p></li>
<li><p><code>repetitive</code>—values may be repeated.</p></li>
<li><p><code>ecma</code>—this dignifies everything that is in ECMA’s book.</p></li>
<li><p><code>json</code>—this data type can be fed to <code>JSON.stringify</code> / <code>as_json</code></p></li>
<li><p><code>basic</code>—this pertains to the six data types earlier shown in the first group of JS native data types.</p></li>
</ul></li>
</ul>
<p id="section-22"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-10">Type Hierarchy (and what we can do with it)</h1>
<h2 id="matching-types-and-methods">Matching Types and Methods</h2>
<ul>
<li><p>A peek into <code>COFFEENODE/Λ/registry/jstypes</code>:</p>
<pre><code>#-----------------------------------------------------------------------------------------
module.exports = ( require '../_read-registry-jstypes' )
  'boolean':        'ecma json basic'
  'function':       'callable ecma basic'
  'list':           'mutable indexed facetted dense ordered repetitive ecma json basic'
  'null':           'single-valued ecma json basic'
  'number':         'numeric ecma json basic'
  'pod':            'mutable facetted ecma json basic'
  'text':           'indexed facetted dense ordered ecma json basic'
  'jsarguments':    'mutable indexed facetted dense ordered repetitive ecma'
  'jsdate':         'mutable ecma'
  'jserror':        'ecma'
  'jsglobal':       'mutable facetted ecma'
  'jsinfinity':     'single-valued ecma'
  'jsnotanumber':   'ecma'
  'jsregex':        'ecma'
  'jsundefined':    'undefined ecma'
</code></pre></li>
</ul>
<div class="figure">
<img src="./resources/coffeenode-jstype-features.png" /><p class="caption"></p>
</div>
<ul>
<li><p>A peek into <code>COFFEENODE/Λ/registry/specific-methods</code>:</p>
<pre><code>#-----------------------------------------------------------------------------------------
module.exports = ( require '../_read-registry-specific-Λ-methods' )
  'add':                        '?facetted ?numeric'
  'first-value-of':             '+ordered'
  'names-of':                   '-indexed +facetted'
  'idxs-of':                    '+indexed'
  'normalize':                  '*'
  'words-of':                   '?text'
</code></pre></li>
</ul>
<div class="figure">
<img src="./resources/coffeenode-specific-%CE%94-methods.png" /><p class="caption"></p>
</div>
<ul>
<li><p>When a ‘type-specific Δ method’ is called for, we check whether the description of the type of the first argument ‘matches’ the description of the method:</p>
<ul>
<li><p><code>?</code> specifies an <strong>optional tag</strong>—at least one of the optional tags must appear in the type’s tags;</p></li>
<li><p><code>+</code> specifies a <strong>mandatory tag</strong>—all mandatory tags must appear in the type’s tags;</p></li>
<li><p><code>-</code> specifies a <strong>forbidden tag</strong>—none of the forbidden tags may appear in the type’s tags;</p></li>
<li><p><code>*</code> specifies <strong>match any type</strong>—this may not be combined with other tags.</p></li>
</ul></li>
<li><p>The matching process is not fully general, as more complicated patterns are not possible. You cannot currently say <em>match either ( a and b ) or else ( c and d )</em>. It appears to suffice though.</p></li>
<li><p>Because each type is tagged with its own name, you always have the choice to match types and methods simply by naming the types that the method applies to.</p></li>
<li><p>This is what happens with <code>words_of</code>. One could argue that this method is <em>much too peculiar to earn the distinction of being globally available</em> (which is not quite true anyway), but i strongly feel that the vast majority of methods in the <code>jstypes</code> library <em>should</em> attain that status.</p></li>
</ul>
<p id="section-23"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-11">Type Hierarchy (and what we can do with it)</h1>
<h2 id="extension-types-have-tags-too">Extension Types have Tags, too</h2>
<ul>
<li><p>This is `COFFEENODE/SET/type-descriptions.coffee:</p>
<pre><code>module.exports =
  'SET/set':
    'features':             'mutable facetted json'
</code></pre></li>
<li><p>Tagging of extension types ensure that we can go on a smooth path from patching native types to integrating extension types.</p></li>
</ul>
<p id="section-24"></p>
</div>
<div class="slide">
<h1 id="type-hierarchy-and-what-we-can-do-with-it-12">Type Hierarchy (and what we can do with it)</h1>
<h2 id="keeping-peace-avoiding-conflicts">Keeping Peace, Avoiding Conflicts</h2>
<ul>
<li><p>OK so earlier we said that <em>even if we could fix the JS <code>===</code> operator, we shouldn’t do that</em>: <strong>don’t change global semantics</strong>.</p></li>
<li><p>Now what happens if one part of your application relies on <code>new_set 42</code> to fail miserably, while the other half of your brain is just rejoicing about having implemented <code>NUMBER/as_set</code>?</p></li>
<li><p>Because of the way CoffeeNode works, that very much <em>looks</em> like a global change, no?</p></li>
<li><p>And you would be right.</p></li>
<li><p>But there’s help: enlightened reincarnated programmers that spent decades in DLL Hell in their earlier lives have enabled NodeJS modules to specify exactly which versions of dependencies a given module needs—meaning you can have several versions of the <em>same</em> module servicing the <em>same</em> application.</p></li>
<li><p>This is great news. I can sleep again. 未來光明。</p></li>
<li><p>Until i start scratching my head over how to exactly implement that.</p></li>
<li><p>Some day.</p></li>
<li><p>BTW we’re sort of prepared for that—each CoffeeNode library module is (planned to become) an installable entry in the npm module registry and on GitHub.com.</p></li>
</ul>
<p id="section-25"></p>
</div>
<div class="slide">
<h1 id="method-call-styles">Method Call Styles</h1>
<ul>
<li><p>There are several ways to call library methods:</p>
<ul>
<li><p>Easiest, slowest: use Δ methods. This will do signal emission and argument validation behind the scenes; you only have to care for the type library responsible for the prinicipal noun to support the verb:</p>
<pre><code>push names, user_name
</code></pre></li>
<li><p>Type-safest, a little faster: call library methods. This will still do validation, but this time the code is annotated: ‘hey i believe i’m having a list here, so please check that and push a value’. Yo get type validation with no extra syntax!</p>
<pre><code>LIST.push names, user_name
</code></pre></li>
<li><p>Less type-safe, yet a little faster: use library implementation methods:</p>
<pre><code>LIST._.push names, user_name
</code></pre></li>
<li><p>Most problematic, fastest: use native JS object methods. In this particular case, the <code>push</code> method is without major flaws, although it acts a bit strange in case the pushee should happen to be <code>undefined</code>:</p>
<pre><code>names.push user_name
</code></pre></li>
</ul></li>
<li><p>In JavaScript and other modern languages, things like collection manipulation etc. are built into the language, together with an API that manages access to these facilities. One could argue that these should <em>not</em> be concerns for the language proper, but a matter of libraries. In fact, i argue that even <em>the very syntax</em> of the language itself can be moved into a library.</p></li>
</ul>
<p id="section-26"></p>
</div>
<div class="slide">
<h1 id="how-&#963;-works">How Σ works</h1>
<ul>
<li><p>A synchronous signal handling library</p></li>
<li><p>API:</p>
<ul>
<li><p>You create a signal by calling <code>Σ.emit</code>; first argument is the signal name, other arguments as required for the purpose:</p>
<pre><code>x = Σ.emit 'signal-name', 42, 108
</code></pre></li>
<li><p>You catch a signal by passing a signal matcher and a listener function to <code>Σ.listen</code>; listeners take the signal as first argument and other arguments as required for the purpose:</p>
<pre><code>Σ.listen 'signal-matcher', ( signal, foo, bar ) -&gt;
    ...
    Σ.update signal, 'new '
</code></pre></li>
<li><p>When you look into the signal, you’ll find the first optional argument got treated specially—it becomes <code>signal[ 'value' ]</code>:</p>
<pre><code>{ '~isa': 'Σ/signal'
  name:                 'signal-name'
  arguments:            [ 42, 108 ]
  value:                42
  count:                1
  'is-mandatory':       false
  'listener-locators':  [ 'file:///route/to/script.cnd#39,3' ],
  data: null }
</code></pre></li>
<li><p>You can rename a signal; this will modify signal[ ‘name’ ]</p>
<pre><code>Σ.listen 'signal-matcher', ( signal, arguments... ) -&gt;
    ...
    Σ.update signal, 'new '
</code></pre></li>
</ul></li>
</ul>
<p id="section-27"></p>
</div>
<div class="slide">
<h1 id="comparison-of-programming-languages">Comparison of Programming Languages</h1>
<div class="figure">
<img src="./resources/computer-languages-on-a-hertzsprung-russell-diagram.png" alt="Hertzsprung-Russell Diagram of Computer Languages" /><p class="caption">Hertzsprung-Russell Diagram of Computer Languages</p>
</div>
<p id="section-28"></p>
</div>
<div class="slide">
<h1 id="comparison-of-programming-languages-contd">Comparison of Programming Languages (cont’d)</h1>
<div class="figure">
<img src="./resources/computer-languages-on-a-hertzsprung-russell-diagram-small.png" /><p class="caption"></p>
</div>
<ul>
<li><p>Some languages are so crazy, you can hardly use them properly if you care for manageable, correct algorithms.</p></li>
<li><p>One example is PHP, which is only marginally less crazy than Brainfuck. You can only write correct programs if you read up on 10 years of user discussion revealing bugs and giving workarounds—for each single function. Things are not getting fixed in PHP, they get discussed in the online manual. PHP has an surprisingly complicated syntax. PHP cannot speak Unicode, so why should you care to speak PHP?</p></li>
<li><p>Another example is Ruby, whose followers worship Monkey Patching.</p></li>
<li><p>Another well-known example is Perl, whose gotchas are not oversights or accidents, but intentionally built into the language. Here’s the reason i never continued to program in Perl:</p>
<ul>
<li><p>Assigns <code>'c'</code> to <code>$foo</code> and throws the rest of the array away:</p>
<pre><code>$foo = ( 'a', 'b', 'c' );
</code></pre></li>
<li><p>This looks like it should do the same thing as the first example, but instead it sets <code>$foo</code> to the length of <code>@foo</code>, so <code>$foo == 3</code>:</p>
<pre><code>@foo = ( 'a', 'b', 'c' );
$foo = @foo;
</code></pre></li>
</ul></li>
</ul>
<p id="section-29"></p>
</div>
<div class="slide">
<h1 id="comparison-of-programming-languages-contd-1">Comparison of Programming Languages (cont’d)</h1>
<div class="figure">
<img src="./resources/computer-languages-on-a-hertzsprung-russell-diagram-small.png" /><p class="caption"></p>
</div>
<ul>
<li><p>Java is crazy from overzealous bureaucracy:</p>
<pre><code>class x {
    public static void main( String args[] ) {
        System.out.println( &quot;Hello World!&quot; ); } }
</code></pre></li>
<li><p>and guilty of forcing its implementation details down the throats of its users:</p>
<blockquote>
<p>“The Float class wraps a value of primitive type float in an object. An object of type Float contains a single field whose type is float.”—<a href="http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Float.html"><em>Java Manual</em></a></p>
</blockquote></li>
<li><p>For all that Java does to enslave its users, itself takes a rather lighthearted view of life and the universe:</p>
<pre><code>1.0 / 0.0                       /* Infinity */
0.0 / 0.0                       /* NaN      */
Math.sqrt( -2.0 )               /* NaN      */
NaN == NaN                      /* false    */
(int) ( Double.NaN )            /* 0        */
</code></pre></li>
<li><p>This is just the tip of the iceberg of idiocy:</p>
<blockquote>
<p>“To make matters worse, the rules for comparing NaN and –0 are different between the primitive float type and the wrapper class Float. For float values, comparing two NaN values for equality will yield false, but comparing two NaN Float objects using Float.equals() will yield true. The motivation for this is that otherwise it would be impossible to use an NaN Float object as a key in a HashMap. Similarly, while 0 and —0 are considered equal when represented as float values, comparing 0 and —0 as Float objects using Float.compareTo() indicates that —0 is considered to be less than 0.”—<a href="http://www.ibm.com/developerworks/java/library/j-jtp0114/"><em>Java theory and practice</em></a></p>
</blockquote></li>
<li><p>Do you trust a computer language that fails on <code>0 == —0</code>?</p></li>
</ul>
<p id="section-30"></p>
</div>
<div class="slide">
<h1 id="comparison-of-programming-languages-contd-2">Comparison of Programming Languages (cont’d)</h1>
<div class="figure">
<img src="./resources/computer-languages-on-a-hertzsprung-russell-diagram-small.png" /><p class="caption"></p>
</div>
<ul>
<li><p>C++ is crazy because while it gives you the power to rule the universe, it does nothing to help you free allocated memory or do text manipulation. You’ll have to run the world using nothing but a set of screwdrivers, some of them with pretty patterns. Good luck.</p></li>
<li><p>C is like C++, only the screwdrivers have no fancy patterns.</p></li>
<li><p>Assembler is like C, but the screwdrivers are flintstones.</p></li>
<li><p>Basic is like C, minus the screwdrivers. Craziness gone, but very boring.</p></li>
<li><p>VisualBasic pretends to be simple and manages to be circumlocutory. It is a strange parasite that is inextricably interwoven with the intestines of its hosts, which are Microsoft Office applications.</p></li>
</ul>
<p id="section-31"></p>
</div>
<div class="slide">
<h1 id="comparison-of-programming-languages-contd-3">Comparison of Programming Languages (cont’d)</h1>
<div class="figure">
<img src="./resources/computer-languages-on-a-hertzsprung-russell-diagram-small.png" /><p class="caption"></p>
</div>
<ul>
<li><p>Python tries to be sane and a role model for OOP.</p></li>
<li><p>Its number systems is easily the best one i’ve ever seen.</p></li>
<li><p>Many other aspects are very reasonable.</p></li>
<li><p>Its syntax is pretty simple, almost boring.</p></li>
<li><p>But Python’s developers are so smart they’ve become very, very stubborn.</p></li>
<li><p>No experiments here.</p></li>
<li><p>It is not crazy enough for me.</p></li>
</ul>
<p id="section-32"></p>
</div>
<div class="slide">
<h1 id="comparison-of-programming-languages-contd-4">Comparison of Programming Languages (cont’d)</h1>
<div class="figure">
<img src="./resources/computer-languages-on-a-hertzsprung-russell-diagram-small.png" /><p class="caption"></p>
</div>
<ul>
<li><p>JavaScript’s craziness is one of the most widely known facts of Computer Science.</p></li>
<li><p>But its flexibility, simplicity and straightforwardness are much less well known.</p></li>
<li><p>Python has an <code>import</code> statement, an unwieldy beast. NodeJS has the <code>require</code> function, which is <strong>more straightforward and more powerful, but without the complexities of <code>import</code></strong>.</p></li>
<li><p>Pythoneers are often afflicted by Compulsory Typing Disorder. When you <code>import</code> something, then that something is a <code>Module</code>, something that is not a class, an instance or anything else. The entity’s type is completely useless.</p></li>
<li><p>But we always have to type everything, right?</p></li>
<li><p>Nope:</p>
<p>in module <code>meaning-of-everything.coffee</code>:</p>
<pre><code>module.exports = 42
</code></pre>
<p>in module <code>show-me-the-answers.coffee</code>:</p>
<pre><code>log require './meaning-of-everything.coffee'
</code></pre>
<p>gives you <code>42</code>. You just ‘imported a number’. Or anything else. Maybe the binary data of an image.</p></li>
<li><p>Often it is practical to just import a single function with <code>require</code>.</p></li>
</ul>
<p id="section-33"></p>
</div>
<div class="slide">
<h1 id="comparison-of-programming-languages-contd-5">Comparison of Programming Languages (cont’d)</h1>
<div class="figure">
<img src="./resources/computer-languages-on-a-hertzsprung-russell-diagram-small.png" /><p class="caption"></p>
</div>
<ul>
<li><p>For me, the ‘Inhabitable Zone’ of programming languages is between JavaScript and Python.</p></li>
<li><p>When you move from JavaScript to CoffeeScript, you considerably reduce the amount of craziness that could vex you. This is because</p></li>
<li><p>you get rid of 99.9% of all braces and parentheses;</p></li>
<li><p>you implicitly use JavaScript’s non-coercing ‘strict equality’ operator, avoiding many gotchas;</p></li>
<li><p>you get a great syntax for function definition (very important in asynchronous, callback-rich code):</p>
<pre><code>f = ( a, b, c = 42 ) -&gt;
  return &quot;#{a} #{b} #{c}&quot;

g = ( names... ) -&gt;
  return &quot;The participants: #{names.join ', '}&quot;
</code></pre></li>
<li><p>for those who like it, you get easy-to-use classes (i have no use for them, as i do mixins / traits);</p></li>
<li><p>you get the existential operator <code>?</code> which is great to circumnavigate the many cases where missing attributes result in <code>undefined</code>:</p>
<pre><code>solipsism = true if mind? and not world?

speed ?= 75                                 # caveat: may create a global variable in CS 1.2.0; issue fixed

footprints = yeti ? &quot;bear&quot;
</code></pre></li>
<li><p>you get post-<code>if</code> statements, list comprehensions, ranges, sane <code>for ... in / of</code> loops;</p></li>
<li><p>you can use all of JavaScript and everything that 3rd party libraries offer—in most cases, it is absolutely trivial to turn some library into a <code>require</code>able module.</p></li>
<li><p>I’ve only scratched the surface here.</p></li>
</ul>
<p id="section-34"></p>
</div>
<div class="slide">
<h1 id="flowmatic-beyond-.cnd">FlowMatic: Beyond <code>*.cnd</code></h1>
<ul>
<li><p>We’ve seen that we can do <em>lot</em> with <code>*.cnd</code> modules.</p></li>
<li><p>It’s almost a new language.</p></li>
<li><p>Almost.</p></li>
<li><p>Except we have no handle to manipulate the non-verbal / syntactical behaviors.</p></li>
<li><p>All of this stuff is beyond our reach, and similar constructs cannot be introduced:</p>
<pre><code>x + y
x[ 3 ] = 42
a = [ 8, 7, 6, ]
f()
</code></pre></li>
<li><p><code>x[ 'foo' ] == undefined</code> is the source for an important class of silent failures in JavaScript, and we’re still unable to fix this with CoffeeScript and <code>*.cnd</code> alone.</p></li>
<li><p>Extending the syntax of CoffeeScript is feasible, but cumbersome.</p></li>
<li><p>I’d really like to explore what we could do if we had a flexible system where we can easily define new syntax—both to</p>
<ul>
<li><p>define more eloquent idioms that approach natural language, and to</p></li>
<li><p>define more formulaic / terser idioms.</p></li>
</ul></li>
</ul>
<p id="section-35"></p>
</div>
<div class="slide">
<h1 id="flowmatic-beyond-.cnd-1">FlowMatic: Beyond <code>*.cnd</code></h1>
<div class="figure">
<img src="./resources/flowmatic-logo-3.0.png" /><p class="caption"></p>
</div>
<p id="section-36"></p>
</div>
<div class="slide">
<h1 id="flowmatic-beyond-.cnd-2">FlowMatic: Beyond <code>*.cnd</code></h1>
<div class="figure">
<img src="./resources/flowmatic-logo-3.0-small.png" /><p class="caption"></p>
</div>
<ul>
<li><p>Both formulaic and eloquent programming has been done before.</p></li>
<li><p>The first eloquent programming language in history was invented between 1953 and 1959 by Grace Hopper (1906–1992), who called it FLOW-MATIC. A sample (slightly edited):</p>
<pre><code>      ....................................................................................
 (0)  input  inventory  file-a price        file-b;
      output priced-inv file-c unpriced-inv file-d;
      hsp d.

      ....................................................................................
 (1)  compare product-no (a) with product-no (b);
      if greater  go to operation 10;
      if equal    go to operation 5;
      otherwise   go to operation 2.

      ....................................................................................
 (2)  transfer a to d.
 (3)  write-item d.
 (4)  jump to operation 8.

      ....................................................................................
 (5)  transfer a to c.
 (6)  move unit-price (b) to unit-price (c).
 (7)  write-item c.
 (8)  read-item a;
      if end of data go to operation 14.
 (9)  jump to operation 1.

      ....................................................................................
(10)  read item b;
      if end of data go to operation 12.
(11)  jump to operation 1.

      ....................................................................................
(12)  set operation 9 to go to operation 2.
(13)  jump to operation 2.

      ....................................................................................
(14)  test product-no (b) against zzzzzzzzzzzz;
      if equal  go to operation 16;
      otherwise go to operation 15.
(15)  rewind b.

      ....................................................................................
(16)  close-out files c; d.
(17)  stop. (end)
</code></pre></li>
</ul>
<p id="section-37"></p>
</div>
<div class="slide">
<h1 id="flowmatic-beyond-.cnd-3">FlowMatic: Beyond <code>*.cnd</code></h1>
<div class="figure">
<img src="./resources/flowmatic-logo-3.0-small.png" /><p class="caption"></p>
</div>
<ul>
<li><p>Probably the tersest programming language ever is APL, which was developed by Kenneth E. Iverson in 1964.</p></li>
<li><p>This program finds all prime numbers from <code>1</code> to <code>R</code>:</p>
<pre><code>(~R∊R∘.×R)/R←1↓⍳R
</code></pre></li>
<li><p>And this one takes a boolean matrix and calculates the new generation according to the rules of Conway’s Game of Life:</p>
<pre><code>life←{↑1 ⍵∨.∧3 4=+/,¯1 0 1∘.⊖¯1 0 1∘.⌽⊂⍵}
</code></pre></li>
<li><p>My guess is that most usable / desirable / practical / learnable / popular syntaxes will fall somewhere in between the two extremes shown.</p></li>
<li><p>Well, there are exceptions. Example: Ideographic Description Language, a Unicode standard to allow for the graphic decomposition of Chinese characters:</p>
<pre><code>參: ⿱厽㐱
厽: ⿱厶厸
厸: ⿰厶厶
㐱: ⿱人彡

參: ⿱⿱厶厸㐱
參: ⿱⿱厶⿰厶厶㐱
參: ⿱⿱厶⿰厶厶⿱人彡
</code></pre></li>
<li><p>Syntactically, CoffeeScript is very close to what i consider ideal for general purposes.</p></li>
</ul>
<p id="section-38"></p>
</div>
<div class="slide">
<h1 id="flowmatic-beyond-.cnd-4">FlowMatic: Beyond <code>*.cnd</code></h1>
<div class="figure">
<img src="./resources/flowmatic-logo-3.0-small.png" /><p class="caption"></p>
</div>
<div class="figure">
<img src="./resources/turris-babel-1092x1123.jpg" /><p class="caption"></p>
</div>
<p id="section-39"></p>
</div>
<div class="slide">
<h1 id="flowmatic-beyond-.cnd-5">FlowMatic: Beyond <code>*.cnd</code></h1>
<div class="figure">
<img src="./resources/flowmatic-logo-3.0-small.png" /><p class="caption"></p>
</div>
<ul>
<li><p>When we program in JavaScript, there are still cases where a careful programmer should keep a however misty awreness of the C foundations of that language, for example when reasoning about numerical correctness. CoffeeNode can’t help you in this respect, either.</p></li>
<li><p>It is not easy to get rid of that without having to deal with a lot of things such as BigDecimal APIs</p></li>
<li><p>which is conceptual clutter as far as proper programm execution is the target.</p></li>
<li><p>Only when we write a new language that hides these implementation details form the user can we make real advancements in expressivity.</p></li>
<li><p>FlowMatic is not a language per se, it’s more of a toolbox to author languages.</p></li>
<li><p>But there is still a plan to give it one ‘central’ or ‘default’ dialect (ideas for a name welcome) which will be very close to CoffeeScript</p></li>
<li><p>mainly as a way to lower entry levels for newbies</p></li>
<li><p>and because CoffeeScript is a <em>pretty</em> good language, of course.</p></li>
</ul>
<p id="section-40"></p>
</div>
<div class="slide">
<h1 id="flowmatic-beyond-.cnd-6">FlowMatic: Beyond <code>*.cnd</code></h1>
<div class="figure">
<img src="./resources/flowmatic-logo-3.0-small.png" /><p class="caption"></p>
</div>
<ul>
<li>These are the number formats i envision for the central dialect:</li>
</ul>
<table>
<col width="19%" />
<col width="26%" />
<col width="53%" />
<tbody>
<tr class="odd">
<td align="left">integer</td>
<td align="left"><code>576553498</code><br /><code>87'651</code></td>
<td align="left"><br />Optional digit groups.</td>
</tr>
<tr class="even">
<td align="left">float</td>
<td align="left"><code>87'651.45</code><br /><code>5345.3e12</code></td>
<td align="left">All floats must have a decimal mark.<br />Optional exponent.</td>
</tr>
<tr class="odd">
<td align="left">decimal</td>
<td align="left"><code>132!</code><br /><code>244324!000</code><br /><code>1:342</code></td>
<td align="left">Decimal integer, remains integer in operations.<br />Same, but rounded to thousands.<br />Decimal float with precision 3.</td>
</tr>
<tr class="even">
<td align="left">quantity</td>
<td align="left"><code>12kg</code><br /><code>1755!µg</code><br /><code>12:98€</code></td>
<td align="left">Number with (registered) unit.<br />Will keep precise to µgrams.<br />Monetary value with cent precision.</td>
</tr>
<tr class="odd">
<td align="left">scaled</td>
<td align="left"><code>64k</code><br /><code>23.0milli</code></td>
<td align="left">Same as <code>64'000</code>.<br />Same as <code>0.0023</code>.</td>
</tr>
<tr class="even">
<td align="left">imaginary</td>
<td align="left"><code>3.5j</code></td>
<td align="left">Same as <code>3.5 * √ -1</code></td>
</tr>
<tr class="odd">
<td align="left">complex</td>
<td align="left"><code>3.5j4.2</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">hexadecimal</td>
<td align="left"><code>0x45ac2</code><br /><code>0x1'0000'04f8</code><br /></td>
<td align="left">Always integer.<br />Optional Grouping.</td>
</tr>
<tr class="odd">
<td align="left">octal</td>
<td align="left"><code>0o775</code><br /></td>
<td align="left">Always integer.<br /></td>
</tr>
<tr class="even">
<td align="left">binary</td>
<td align="left"><code>0b00110001</code><br /><code>0b'0011'0001</code><br /></td>
<td align="left">Always integer.<br />Optional Grouping.</td>
</tr>
<tr class="odd">
<td align="left">other bases</td>
<td align="left"><code>03_2110</code><br /><code>08_775</code></td>
<td align="left">Base 3.<br />Base 8.</td>
</tr>
<tr class="even">
<td align="left">roman (o_O)</td>
<td align="left"><code>0rMMXII</code><br /></td>
<td align="left">2012.<br /></td>
</tr>
</tbody>
</table>
<ul>
<li><p>To give an example, <code>2:63~€</code> is</p>
<ul>
<li><p>a <code>quantity</code></p></li>
<li><p>with magnitude <code>2.63</code></p></li>
<li><p>and unit <code>€</code>.</p></li>
<li><p>It has a decimal precision of 2;</p></li>
<li><p>In numerical operations, the ‘round half away from zero’ rule is applied, which is widely used in commercial applictions.</p></li>
</ul></li>
<li><p>Whether the Roman numeral format will make it into the central dialect is not clear.</p></li>
<li><p>But <em>is</em> clear that FlowMatic will include ways to</p>
<ul>
<li><p>Define your own formats (for number parsing, but also for entire statement syntax),</p></li>
<li><p>derive a new grammar from an existing one,</p></li>
<li><p>and markup file names and file contents to ensure the correct dialect is used for parsing.</p></li>
</ul></li>
<li><p>When that ability comes around, fierce discussions and year-long waiting periods for new syntactical features will very much have become part of the past</p></li>
<li><p>because anyone can just fork a dialect and start using it</p></li>
<li><p>without touching any other part of the language.</p></li>
<li><p>Language versioning will be a <em>very</em> different beat from what we know today;</p></li>
<li><p>basically, linear versioning will be replaced by tagged multidimensional versioning.</p></li>
<li><p>You could specify a format with a function call to get roman numerals:</p>
<pre><code>myformat: new-language
    extension:  'foo'
    uses:
      :central 3557
      :0.3 &lt; roman-numerals &lt; 0.6
</code></pre></li>
</ul>
</div>


</body>
</html>
